<!doctype html>
<html>
<head>
    <title>The Sign Up Cube</title>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>

  <section class="eventDetails">


        <h2><%= signUpResults.eventTitle %></h2>

  </section>


<section class = "displayTimeSlots">

<table class="table">
    <thead class="thead-dark">
      <tr>
        <th scope="col">Date</th>
        <th scope="col">Start Time</th>
        <th scope="col">End Time</th>
        <th scope="col">Location/Activity Description</th>
        <th scope="col">Volunteers Needed</th>
        <th scope="col">Volunteers Signed Up</th>
        <th scope="col">Sign Up</th>
      </tr>
    </thead>
    <tbody>
        <% for(var i =0; i <timeSlotResults.length; i++) { %>
            
        <tr>
            <!-- <th scope="row"></th> -->
            <td><%= timeSlotResults[i].date %></td>
            <td><%= timeSlotResults[i].startTime %></td>
            <td><%= timeSlotResults[i].endTime %></td>
            <td><%= timeSlotResults[i].activityDescription %></td>
            <td>
             <% for (let index = 0; index <guestSignUpResults.length; index++) { %>

               <% if(guestSignUpResults[index].slotId === timeSlotResults[i]._id.toString()) { %>

               <%= guestSignUpResults[index].name %>

               <% } %> 
             <% } %>
            </td>
            <td><%= timeSlotResults[i].numberVolunteersNeeded %></td>
            <td>
              <button class ="buttonSignUp" 
                data-eventId="<%= timeSlotResults[i].eventId %>" 
                data-slotId ="<%= timeSlotResults[i]._id %>" data-recurringId="<%= timeSlotResults[i].recurringId %>"
                data-eventNameInfo ="<%= timeSlotResults[i].eventName %>"
                data-slotDate ="<%= timeSlotResults[i].date %>"
                data-startTime ="<%= timeSlotResults[i].startTime %>"
                data-endTime ="<%= timeSlotResults[i].endTime %>"
                data-activityDes ="<%= timeSlotResults[i].activityDescription %>"
                
                >Sign Up</button>
            </td>

            <input type ="hidden" data-eventName ="<%= timeSlotResults[i].eventName %>">
        </tr>

        <% } %>
    </tbody>
  </table>
 
</section>

<% if( typeof user !== 'undefined' ) { %>
  <% console.log('user loggedin') %>

  
  <button class ="buttonLogOut">LOG OUT</button>
 
  
<% } %>

<% if( typeof user === 'undefined') { %>
  <div class="modal">
   <div class="modal-header">
    <span class="close-btn">&times;</span>
    <h1>Sign Up</h1>
  </div>
  <div class="modal-content">
    
    <form action ="/guestSignUp" method ="POST">
      <p>Name</p>
      <input type ="text" name ="guestName">

      <p>Email</p>
      <input type ="email" name ="guestEmail">

      <p>Phone Number</p>
      <input type="tel" name ="guestTel">

      <input type="hidden" name ="guestEventId">

      <input type="hidden" name ="guestSlotId">

      <input type="hidden" name ="guestRecurringId">

      <input type="hidden" name ="eventNameFilled">

      <input type="hidden" name ="slotDateFilled">

      <input type="hidden" name ="startTimeFilled">

      <input type="hidden" name ="endTimeFilled">

      <input type="hidden" name ="actDesFilled">

      <button class ="buttonSubmitGuest">Sign Up As Guest</button>
    </form>

     <!-- LOGIN FORM -->
     <h2>Login To Sign Up</h2>
     <form action="/loginSignUp" method="post">
       <div class="form-group">
           <label>Email</label>
           <input type="text" class="form-control" name="email">
       </div>
       <div class="form-group">
           <label>Password</label>
           <input type="password" class="form-control" name="password">
       </div>

       <input type ="hidden" name ="eventIdPublic" value ="<%= signUpResults._id %>">

       <button type="submit" class="btn btn-warning btn-lg">Login</button>
     </form>
 
     <p>Need an account? <a href="/signup">Signup</a></p>
     
 
   </div>
   <div class="modal-footer">
     <h2></h2>
   </div>
 </div>

<% } else if (user.local.email) { %>
  
  <div class="modal">
    <div class="modal-header">
     <span class="close-btn">&times;</span>
     <h1>Sign Up</h1>
   </div>
   <div class="modal-content">
     
     <form action ="/guestSignUp" method ="POST">
       <p>Name</p>
       <input type ="text" name ="guestName" value = <%= user.local.displayName %>>
 
       <p>Email</p>
       <input type ="email" name ="guestEmail" value = <%= user.local.email %>>
 
       <p>Phone Number</p>
       <input type="tel" name ="guestTel" value = <%= user.local.telephone %>>
 
       <input type="hidden" name ="guestEventId">
 
       <input type="hidden" name ="guestSlotId">
 
       <input type="hidden" name ="guestRecurringId">

       <input type="hidden" name ="eventNameFilled">

       <input type="hidden" name ="slotDateFilled">
 
       <input type="hidden" name ="startTimeFilled">
 
       <input type="hidden" name ="endTimeFilled">
 
       <input type="hidden" name ="actDesFilled">
 
       <button class ="buttonSubmitGuest">Sign Up</button>
     </form>
   </div>
   <div class="modal-footer">
     <h2></h2>
   </div>
 </div>
<% } %>


   


<script type="text/javascript" src="main.js"></script>

</body>
</html>




